{"ast":null,"code":"import JsonP from 'jsonp';\nimport axios from 'axios';\nimport { Modal } from 'antd';\nimport Utils from \"../utils/utils\";\nexport default class Axios {\n  static jsonp(options) {\n    return new Promise((resolve, reject) => {\n      JsonP(options.url, {\n        param: 'callback'\n      }, function (err, response) {\n        // TODO\n        if (response.status === 'success') {\n          resolve(response);\n        } else {\n          reject(response.message);\n        }\n      });\n    });\n  }\n\n  static ajax(options) {\n    let loading;\n\n    if (options.data && options.data.isShowLoading !== false) {\n      loading = document.getElementById('ajaxLoading');\n      loading.style.display = 'block';\n    }\n\n    let baseUrl = 'https://www.easy-mock.com/mock/5a7278e28d0c633b9c4adbd7/api';\n    return new Promise((resolve, reject) => {\n      axios({\n        url: options.url,\n        method: 'get',\n        baseURL: baseUrl,\n        timeout: 5000,\n        params: options.data && options.data.params || ''\n      }).then(response => {\n        if (options.data && options.data.isShowLoading !== false) {\n          loading = document.getElementById('ajaxLoading');\n          loading.style.display = 'none';\n        }\n\n        if (response.status === 200) {\n          let res = response.data;\n\n          if (res.code == 0) {\n            resolve(res);\n          } else {\n            Modal.info({\n              title: '提示',\n              content: res.msg\n            });\n          }\n        } else {\n          reject(response.data);\n        }\n      });\n    });\n  }\n\n  static requestList(_this, url, params) {\n    var data = {\n      params: params\n    };\n    this.ajax({\n      url,\n      data\n    }).then(data => {\n      if (data && data.result) {\n        let list = data.result.item_list.map((item, index) => {\n          item.key = index;\n          return item;\n        });\n\n        _this.setState({\n          list: list,\n          pagination: Utils.pagination(res, current => {\n            _this.params.page = current;\n\n            _this.requestList();\n          })\n        });\n      }\n    });\n  }\n\n}","map":{"version":3,"sources":["/Users/habitat/Desktop/share-bus/src/axios/index.js"],"names":["JsonP","axios","Modal","Utils","Axios","jsonp","options","Promise","resolve","reject","url","param","err","response","status","message","ajax","loading","data","isShowLoading","document","getElementById","style","display","baseUrl","method","baseURL","timeout","params","then","res","code","info","title","content","msg","requestList","_this","result","list","item_list","map","item","index","key","setState","pagination","current","page"],"mappings":"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","sourcesContent":["import JsonP from 'jsonp'\nimport axios from 'axios'\nimport { Modal } from 'antd'\nimport Utils from \"../utils/utils\"\n\nexport default class Axios {\n  static jsonp(options) {\n    return new Promise((resolve, reject) => {\n      JsonP(options.url, {\n        param: 'callback'\n      }, function (err, response) {\n        // TODO\n        if (response.status === 'success') {\n          resolve(response)\n        } else {\n          reject(response.message)\n        }\n      })\n    })\n  }\n\n  static ajax(options) {\n    let loading\n    if (options.data && options.data.isShowLoading !== false) {\n      loading  = document.getElementById('ajaxLoading')\n      loading.style.display = 'block'\n    }\n    let baseUrl = 'https://www.easy-mock.com/mock/5a7278e28d0c633b9c4adbd7/api'\n    return new Promise((resolve, reject) => {\n      axios({\n        url: options.url,\n        method: 'get',\n        baseURL: baseUrl,\n        timeout: 5000,\n        params: (options.data && options.data.params) || ''\n      }).then((response) => {\n        if (options.data && options.data.isShowLoading !== false) {\n          loading  = document.getElementById('ajaxLoading')\n          loading.style.display = 'none'\n        }\n        if (response.status === 200) {\n          let res= response.data\n          if (res.code == 0) {\n            resolve(res)\n          } else {\n            Modal.info({\n              title: '提示',\n              content: res.msg\n            })\n          }\n        } else {\n          reject(response.data)\n        }\n      })\n    })\n  }\n\n  static requestList(_this, url, params) {\n    var data = {\n      params: params\n    }\n    this.ajax({\n      url,\n      data\n    }).then((data) => {\n      if (data && data.result) {\n        let list = data.result.item_list.map((item, index) => {\n          item.key = index\n          return item\n        })\n        _this.setState({\n          list: list,\n          pagination: Utils.pagination(res, (current) => {\n            _this.params.page = current\n            _this.requestList()\n          })\n        })\n      }\n    })\n  }\n}"]},"metadata":{},"sourceType":"module"}
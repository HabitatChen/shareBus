{"ast":null,"code":"var _jsxFileName = \"/Users/habitat/Desktop/share-bus/src/page/order/detail.js\";\nimport React from 'react';\nimport { Card } from 'antd';\nimport axios from '../../axios';\nimport './detail.less';\nexport default class Details extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      orderInfo: {}\n    };\n\n    this.renderMap = res => {\n      this.map = new window.BMap.Map(\"orderDetailMap\");\n      this.addMapControl();\n      this.drawBikeRoute(res.position_list); // 调用服务区\n\n      this.drawServiceArea(res.area);\n    };\n\n    this.addMapControl = res => {\n      let map = this.map;\n      map.addControl(new window.BMap.ScaleControl({\n        anchor: window.BMAP_ANCHOR_TOP_LEFT\n      }));\n      map.addControl(new window.BMap.NavigationControl({\n        anchor: window.BMAP_ANCHOR_TOP_LEFT\n      }));\n    };\n\n    this.request = orderId => {\n      axios.ajax({\n        url: '/order/detail',\n        data: {\n          params: {\n            orderId\n          }\n        }\n      }).then(res => {\n        if (res.code == 0) {\n          this.setState({\n            orderInfo: res.result\n          });\n          this.renderMap(res.result);\n        }\n      });\n    };\n\n    this.drawBikeRoute = pointList => {\n      let map = this.map;\n      let startPoint = '';\n      let endPoint = '';\n\n      if (pointList.length > 0) {\n        let first = pointList[0];\n        let last = pointList[pointList.length - 1];\n        startPoint = new window.BMap.Point(first.lon, first.lat);\n        let startIcon = new window.BMap.Icon('/assets/start_point.png', new window.BMap.Size(36, 42), {\n          imageSize: new window.BMap.Size(36, 42),\n          anchor: new window.BMap.Size(36, 42)\n        });\n        let startMaker = new window.BMap.Marker(startPoint, {\n          icon: startIcon\n        });\n        this.map.addOverlay(startMaker);\n        endPoint = new window.BMap.Point(last.lon, last.lat);\n        let endIcon = new window.BMap.Icon('/assets/end_point.png', new window.BMap.Size(36, 42), {\n          imageSize: new window.BMap.Size(36, 42),\n          anchor: new window.BMap.Size(36, 42)\n        });\n        let endMaker = new window.BMap.Marker(endPoint, {\n          icon: endIcon\n        });\n        this.map.addOverlay(endMaker); // 连接路线图\n\n        let trackPoint = [];\n\n        for (let i = 0; i < pointList.length; i++) {\n          let point = pointList[i];\n          trackPoint.push(new window.BMap.Point(point.lon, point.lat));\n        } // 画线\n\n\n        let polyline = new window.BMap.Polyline(trackPoint, {\n          strokeColor: '#1869ad',\n          strokeWeight: 3,\n          strokeOpacity: 1\n        });\n        this.map.addOverlay(polyline);\n        this.map.centerAndZoom(endPoint, 11);\n      }\n    };\n\n    this.drawServiceArea = position_list => {\n      // 连接路线图\n      let trackPoint = [];\n\n      for (let i = 0; i < position_list.length; i++) {\n        let point = position_list[i];\n        trackPoint.push(new window.BMap.Point(point.lon, point.lat));\n      } // 绘制服务区\n\n\n      let polygon = new window.BMap.Polygon(trackPoint, {\n        strokeColor: 'red',\n        strokeWeight: 4,\n        strokeOpacity: 1,\n        fillColor: '#ff8605',\n        fillOpacity: '0.4'\n      });\n      this.map.addOverlay(polygon);\n    };\n  }\n\n  componentDidMount() {\n    let orderId = this.props.match.params.orderId; // 获取动态路由的ID\n\n    if (orderId) {\n      this.request(orderId);\n    }\n  }\n\n  render() {\n    const info = this.state.orderInfo || {};\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, React.createElement(Card, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      id: \"orderDetailMap\",\n      className: \"order-map\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, \" \"), React.createElement(\"div\", {\n      className: \"detail-items\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"item-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, \" \\u57FA\\u7840\\u4FE1\\u606F \"), React.createElement(\"ul\", {\n      className: \"detail-list\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }, React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"detail-form-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, \" \\u7528\\u8F66\\u6A21\\u5F0F \"), React.createElement(\"div\", {\n      className: \"detail-form-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }, info.name == 1 ? '服务区' : '停车点')), React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"detail-form-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }, \" \\u8BA2\\u5355\\u7F16\\u53F7 \"), React.createElement(\"div\", {\n      className: \"detail-form-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, info.order_sn)), React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"detail-form-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }, \" \\u8F66\\u8F86\\u7F16\\u53F7 \"), React.createElement(\"div\", {\n      className: \"detail-form-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }, info.bike_sn)), React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"detail-form-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, \" \\u7528\\u6237\\u59D3\\u540D \"), React.createElement(\"div\", {\n      className: \"detail-form-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }, info.user_name)), React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"detail-form-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, \" \\u624B\\u673A\\u53F7 \"), React.createElement(\"div\", {\n      className: \"detail-form-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, info.mobile)))), React.createElement(\"div\", {\n      className: \"detail-items\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"item-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }, \" \\u884C\\u9A76\\u8F68\\u8FF9 \"), React.createElement(\"ul\", {\n      className: \"detail-list\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }, React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"detail-form-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, \" \\u884C\\u7A0B\\u8D77\\u70B9 \"), React.createElement(\"div\", {\n      className: \"detail-form-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, info.start_location)), React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"detail-form-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }, \" \\u884C\\u7A0B\\u7EC8\\u70B9 \"), React.createElement(\"div\", {\n      className: \"detail-form-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, info.end_location)), React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"detail-form-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }, \" \\u884C\\u9A76\\u91CC\\u7A0B \"), React.createElement(\"div\", {\n      className: \"detail-form-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    }, info.distance / 1000))))));\n  }\n\n}","map":{"version":3,"sources":["/Users/habitat/Desktop/share-bus/src/page/order/detail.js"],"names":["React","Card","axios","Details","Component","state","orderInfo","renderMap","res","map","window","BMap","Map","addMapControl","drawBikeRoute","position_list","drawServiceArea","area","addControl","ScaleControl","anchor","BMAP_ANCHOR_TOP_LEFT","NavigationControl","request","orderId","ajax","url","data","params","then","code","setState","result","pointList","startPoint","endPoint","length","first","last","Point","lon","lat","startIcon","Icon","Size","imageSize","startMaker","Marker","icon","addOverlay","endIcon","endMaker","trackPoint","i","point","push","polyline","Polyline","strokeColor","strokeWeight","strokeOpacity","centerAndZoom","polygon","Polygon","fillColor","fillOpacity","componentDidMount","props","match","render","info","name","order_sn","bike_sn","user_name","mobile","start_location","end_location","distance"],"mappings":"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","sourcesContent":["import React from 'react'\nimport {Card} from 'antd'\nimport axios from '../../axios'\nimport './detail.less'\n\nexport default class Details extends React.Component {\n\n  state = {\n    orderInfo: {}\n  }\n\n  componentDidMount() {\n    let orderId = this.props.match.params.orderId  // 获取动态路由的ID\n    if  (orderId) {\n      this.request(orderId)\n    }\n  }\n\n  renderMap = (res) => {\n    this.map = new window.BMap.Map(\"orderDetailMap\");\n    this.addMapControl()\n    this.drawBikeRoute(res.position_list)\n    // 调用服务区\n    this.drawServiceArea(res.area)\n  }\n\n  // 添加地图控件\n  addMapControl = (res) => {\n    let map = this.map\n    map.addControl(new window.BMap.ScaleControl({anchor: window.BMAP_ANCHOR_TOP_LEFT}))\n    map.addControl(new window.BMap.NavigationControl({anchor: window.BMAP_ANCHOR_TOP_LEFT}))\n  }\n\n\n  request = (orderId) => {\n    axios.ajax({\n      url: '/order/detail',\n      data: {\n        params: {\n          orderId\n        }\n      }\n    }).then((res) => {\n      if (res.code == 0) {\n        this.setState({\n          orderInfo: res.result\n        })\n        this.renderMap(res.result)\n      }\n    })\n\n  }\n\n  // 绘制用户的行驶路线\n  drawBikeRoute = (pointList) => {\n    let map = this.map\n    let startPoint = ''\n    let endPoint = ''\n    if (pointList.length > 0) {\n      let first = pointList[0]\n      let last = pointList[pointList.length - 1]\n      startPoint = new window.BMap.Point(first.lon, first.lat)\n      let startIcon = new window.BMap.Icon('/assets/start_point.png', new window.BMap.Size(36, 42), {\n        imageSize:  new window.BMap.Size(36, 42),\n        anchor: new window.BMap.Size(36, 42)\n      })\n      let startMaker = new window.BMap.Marker(startPoint, {icon: startIcon})\n      this.map.addOverlay(startMaker)\n\n      endPoint = new window.BMap.Point(last.lon, last.lat)\n      let endIcon = new window.BMap.Icon('/assets/end_point.png', new window.BMap.Size(36, 42), {\n        imageSize:  new window.BMap.Size(36, 42),\n        anchor: new window.BMap.Size(36, 42)\n      })\n      let endMaker = new window.BMap.Marker(endPoint, {icon: endIcon})\n      this.map.addOverlay(endMaker)\n\n      // 连接路线图\n      let trackPoint = [];\n      for (let i = 0; i < pointList.length; i ++) {\n        let point = pointList[i]\n        trackPoint.push(new window.BMap.Point(point.lon, point.lat))\n      }\n\n      // 画线\n      let polyline = new window.BMap.Polyline(trackPoint, {\n        strokeColor: '#1869ad',\n        strokeWeight: 3,\n        strokeOpacity: 1\n      })\n\n      this.map.addOverlay(polyline)\n\n      this.map.centerAndZoom( endPoint, 11);\n\n\n    }\n\n  }\n\n  // 绘制服务区\n  drawServiceArea = (position_list) => {\n    // 连接路线图\n    let trackPoint = [];\n    for (let i = 0; i < position_list.length; i ++) {\n      let point = position_list[i]\n      trackPoint.push(new window.BMap.Point(point.lon, point.lat))\n    }\n    // 绘制服务区\n    let polygon = new window.BMap.Polygon(trackPoint, {\n      strokeColor: 'red',\n      strokeWeight: 4,\n      strokeOpacity: 1,\n      fillColor: '#ff8605',\n      fillOpacity: '0.4'\n    })\n\n    this.map.addOverlay(polygon)\n  }\n\n  render() {\n    const info = this.state.orderInfo || {}\n    return (\n      <div>\n        <Card>\n          <div id='orderDetailMap' className='order-map'> </div>\n          <div className=\"detail-items\">\n            <div className=\"item-title\"> 基础信息 </div>\n            <ul className=\"detail-list\">\n              <li>\n                <div className=\"detail-form-left\"> 用车模式 </div>\n                <div className=\"detail-form-content\">{info.name == 1 ? '服务区' : '停车点'}</div>\n              </li>\n              <li>\n                <div className=\"detail-form-left\"> 订单编号 </div>\n                <div className=\"detail-form-content\">{info.order_sn}</div>\n              </li>\n              <li>\n                <div className=\"detail-form-left\"> 车辆编号 </div>\n                <div className=\"detail-form-content\">{info.bike_sn}</div>\n              </li>\n              <li>\n                <div className=\"detail-form-left\"> 用户姓名 </div>\n                <div className=\"detail-form-content\">{info.user_name}</div>\n              </li><li>\n              <div className=\"detail-form-left\"> 手机号 </div>\n              <div className=\"detail-form-content\">{info.mobile}</div>\n            </li>\n            </ul>\n          </div>\n          <div className=\"detail-items\">\n            <div className=\"item-title\"> 行驶轨迹 </div>\n            <ul className=\"detail-list\">\n              <li>\n                <div className=\"detail-form-left\"> 行程起点 </div>\n                <div className=\"detail-form-content\">{info.start_location}</div>\n              </li>\n              <li>\n                <div className=\"detail-form-left\"> 行程终点 </div>\n                <div className=\"detail-form-content\">{info.end_location}</div>\n              </li>\n              <li>\n                <div className=\"detail-form-left\"> 行驶里程 </div>\n                <div className=\"detail-form-content\">{info.distance / 1000}</div>\n              </li>\n            </ul>\n          </div>\n        </Card>\n      </div>\n    )\n  }\n}\n"]},"metadata":{},"sourceType":"module"}